<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3. Areal Interpolation • smile</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Areal Interpolation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smile</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book fa-lg"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/sf-to-spm.html">1. Converting sf objects to spm</a></li>
    <li><a class="dropdown-item" href="../articles/fit-and-pred.html">2. Fitting models and making predictions</a></li>
    <li><a class="dropdown-item" href="../articles/sai.html">3. Areal Interpolation</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">4. Method</a></li>
    <li><a class="dropdown-item" href="../articles/sp-cov-functions.html">5. Spatial covariance functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search fa-lg"></span> Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://lcgodoy.me"><span class="fa fa-globl"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lcgodoy"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/godoy-lucas/"><span class="fa fa-linkedin"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>3. Areal Interpolation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lcgodoy/smile/blob/main/vignettes/sai.Rmd" class="external-link"><code>vignettes/sai.Rmd</code></a></small>
      <div class="d-none name"><code>sai.Rmd</code></div>
    </div>

    
    
<p>In applied settings, estimating socioeconomic and demographic
variables for different administrative regions within a city is often of
interest. While areal interpolation <span class="citation">(AI,
Goodchild and Lam 1980)</span> easily computes such estimates, it lacks
measures of uncertainty <span class="citation">(Bradley, Wikle, and
Holan 2016)</span>. Our package addresses this by providing both areal
interpolation and methods to approximate the variance of estimates when
the observed data’s variance is known, as is common with survey
data.</p>
<p>This demonstration will utilize 2010 Brazilian Census data from Nova
Lima. The objective is to estimate some variables in a separate map of
the same municipality. The census map with the original data will be
referred to as the “source” map, while the map where the data will be
estimated will be referred to as the “target” map. In this example, the
target map is artificially generated. To initiate the process, the data
and necessary packages can be loaded using the code below. We recommend
using a planar Coordinate Reference System (CRS) when using this
method.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lcgodoy.me/smile/">smile</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nl_ct</span><span class="op">)</span></span>
<span><span class="va">nl_ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">nl_ct</span>, <span class="fl">20823</span><span class="op">)</span></span></code></pre></div>
<p>The code chunk below creates the synthetic target map.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## outer polygon</span></span>
<span><span class="va">nl_outer</span> <span class="op">&lt;-</span> <span class="va">nl_ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_combine.html" class="external-link">st_union</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">smile</span><span class="fu">:::</span><span class="fu"><a href="../reference/st_remove_holes.html">st_remove_holes</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## creating `target` data</span></span>
<span><span class="va">points_nl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">nl_outer</span>,</span>
<span>                       size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nl_vor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">points_nl</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">## voronoi tesselation</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_voronoi</a></span><span class="op">(</span>envelope <span class="op">=</span> <span class="va">nl_outer</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_collection_extract.html" class="external-link">st_collection_extract</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"POLYGON"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_set_crs</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">nl_ct</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">nl_outer</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## creating id variable</span></span>
<span><span class="va">nl_vor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">nl_vor</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="va">nl_vor</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, to estimate one (or several) variable observed at the
<code>nl_ct</code> dataset into the <code>nl_vor</code> data we can run
the following command:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nl_ests</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/AI.html">ai</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">nl_ct</span>,</span>
<span>       target <span class="op">=</span> <span class="va">nl_vor</span>,</span>
<span>       vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hh_density"</span>,</span>
<span>                <span class="st">"avg_income"</span>,</span>
<span>                <span class="st">"avg_age"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## displaying the result</span></span>
<span><span class="va">nl_ests</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id hh_density avg_income  avg_age</span></span>
<span><span class="co">#&gt; 1  1   2.695228   1730.009 24.02146</span></span>
<span><span class="co">#&gt; 2  2   2.477646   2078.178 25.59811</span></span>
<span><span class="co">#&gt; 3  3   3.154861   1729.689 30.22053</span></span>
<span><span class="co">#&gt; 4  4   2.920528   2253.925 30.70541</span></span>
<span><span class="co">#&gt; 5  5   3.300867   7904.903 34.49821</span></span>
<span><span class="co">#&gt; 6  6   3.390798   5468.113 34.89071</span></span></code></pre></div>
<p>In the function above, <code>source</code> is the map/dataset where
the variables to be estimated are observed, while <code>target</code> is
the map/dataset where the estimation is desired. The <code>vars</code>
argument is a character scalar (or vector) specifying the variable(s) in
<code>source</code> to be estimated in <code>target</code>. However,
this function does not quantify uncertainty in the estimates.</p>
<p>If the variance of the variable we wish to estimate in the target map
is available in the source map, we can use the <code>ai_var</code>
function to quantify the uncertainty around our point estimates. The
function is similar to <code>ai</code>, but with a few differences:</p>
<ol style="list-style-type: decimal">
<li><p><code>vars</code> must be a single variable name.</p></li>
<li><p><code>my_var</code> is a character indicating the variable in
source containing the observed variable’s variance.</p></li>
<li><p><code>var_method</code> specifies the method for approximating
variance: Moran’s I (“MI”) for autocorrelation-based approximation, or
Cauchy-Schwarz (“CS”) for an upper bound.</p></li>
<li><p>The current version only supports one variable at a
time.</p></li>
</ol>
<p>The <code>ai_var</code> function outputs the target dataset with two
additional columns: <code>est</code> (estimated variable) and
<code>se_est</code> (approximate standard error).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nl_est</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/AI.html">ai_var</a></span><span class="op">(</span>source <span class="op">=</span> <span class="va">nl_ct</span>,</span>
<span>           target <span class="op">=</span> <span class="va">nl_vor</span>,</span>
<span>           vars <span class="op">=</span> <span class="st">"hh_density"</span>,</span>
<span>           vars_var <span class="op">=</span> <span class="st">"var_hhd"</span>,</span>
<span>           var_method <span class="op">=</span> <span class="st">"MI"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## renaming geometry</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">nl_est</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"geometry"</span></span></code></pre></div>
<p>Below we use <code>ggplot2</code> to plot the observed and estimated
“household density” in the source and target maps, respectively.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">viz_dt</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">nl_ct</span>, source <span class="op">=</span> <span class="st">"Observed"</span>,</span>
<span>                  est <span class="op">=</span> <span class="va">hh_density</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"est"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">nl_est</span>, source <span class="op">=</span> <span class="st">"Estimated"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"source"</span>, <span class="st">"est"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">viz_dt</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span>,</span>
<span>                         name <span class="op">=</span> <span class="st">"Household \n density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">source</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sai_files/figure-html/ggplot-obs-est-1.png" width="700"></p>
<p>Finally, the next map displays the uncertainty about the estimated
household density.</p>
<p><img src="sai_files/figure-html/ggplot-obs-est-viz-1.png" width="700"></p>
<!-- \lcg{fit the sentence below somewhere in the appendix:} -->
<!-- Oftentimes, the variance of each~$Y(B_j)$, $\text{Var}[Y(B_j)]$, is -->
<!-- also available from a census or survey.  -->
<!-- The confidence intervals for the Voronoi interpolation were constructed based on -->
<!-- a normal approximation and in Equation~\eqref{eq:cova}. -->
<!-- Voronoi interpolation is a nonparametric approach that interpolates $Y(B_j)$'s -->
<!-- to construct $Y(s_i)$'s. Define an $n \times m$ matrix -->
<!-- $\mathbf{W} = \{ w_{ij} \}$, where $w_{ij}$ is the weight associated with the -->
<!-- polygon $B_j$ in constructing $Y(s_i)$.  The Voronoi weights are -->
<!-- $w_{ij} = \lvert B_j \cap V_i \rvert / \lvert V_i \rvert$, where -->
<!-- $\lvert \cdot \rvert$ returns the area of a polygon \citep{goodchild1980areal, -->
<!--   gotway2002combining}.  The interpolation for $\hat Y(s_1, \ldots, s_n)$ is -->
<!-- constructed as -->
<!-- \begin{equation} -->
<!--   \label{eq:np-est} -->
<!--   \hat{Y}(s_1, \ldots, s_n) = \mathbf{W} -->
<!--   Y(B_1, \ldots, B_m), -->
<!-- \end{equation} -->
<!-- and implicitly assumes homogeneity within each areal unit. The expectation and -->
<!-- the variance of the predictor are, respectively, -->
<!-- \begin{align*} -->
<!--   \E[\hat{Y}(s_1, \ldots, s_n)] &= \mathbf{W} \E[Y(B_1, \ldots, B_m)]\\ -->
<!--   \text{Var}[\hat{Y}(s_1, \ldots, s_n)] &= \mathbf{W} -->
<!--                                             \text{Var}[Y(B_1, \ldots, B_m)] \mathbf{W}^{\top}. -->
<!-- \end{align*} -->
<!-- In practice, the covariance matrix $\text{Var}[Y(B_1, \ldots, B_m)]$ is unknown -->
<!-- and, consequently, needs to be estimated. In our application, we work census -->
<!-- data, the expectation $\E[Y(B_j)]$ and the marginal population variances -->
<!-- $\text{Var}[Y(B_j)]$ are observed. In survey data, uncertainty around the -->
<!-- estimates $Y(B_j)$ is commonly available and may be used to estimate the -->
<!-- marginal variances. However, in our experience, the off-diagonals entries of the -->
<!-- covariance matrix $\text{Var}[Y(B_1, \ldots, B_m)]$ are unavailable in both -->
<!-- cases and must be estimated or approximated. -->
<!-- The variance of each predictor $\text{Var}[\hat Y(s_i)]$ is needed as an -->
<!-- uncertainty measure, which has not been addressed in the literature. It relies on  -->
<!-- both the variances of $Y(B_j)$'s and their covariances: -->
<!-- \begin{align} -->
<!--   \label{eq:np-single-var} -->
<!--   \text{Var}[\hat{Y}(s_i)]  -->
<!--   = \sum_{j = 1}^m w^2_{ij} \text{Var} \left [ Y(B_j) \right ] + 2 \sum_{l -->
<!--   \neq j} w_{ij} w_{il} \textrm{Cov} \left[ Y(B_j), Y(B_l) \right], -->
<!-- \end{align} -->
<!-- where the variances and covariances terms involving regions such that -->
<!-- $V_i \cap B_j = \varnothing$ are discarded. For practical purposes, we propose -->
<!-- an approximation for $\textrm{Cov}[ Y(B_j), Y(B_l)]$ based on -->
<!-- Moran's~I~\citep{moran1950notes}, a global spatial -->
<!-- autocorrelation. Specifically, let $\rho_I$ be the Moran's~I calculated with a -->
<!-- weight matrix constructed with first-degree neighbors. That is, $\rho_I$ is the -->
<!-- average of the pairwise correlation for all neighboring pairs. If regions $B_j$ -->
<!-- and $B_l$ are neighbors of each other, we have -->
<!-- \begin{align} -->
<!--   \label{eq:cova} -->
<!--   \textrm{Cov} \left[ Y(B_j), Y(B_l) \right] -->
<!--   \approx \rho_I \sqrt{\text{Var}[Y(B_j)]  \text{Var}[Y(B_l)]}. -->
<!-- \end{align} -->
<!-- Otherwise, we set $\textrm{Cov} \left[ Y(B_j), Y(B_l) \right]$ to zero. -->
<!-- This approximation alleviates the conservativeness of using the upper bound from -->
<!-- the Cauchy--Schwartz inequality, in which case, $\rho_I$ is replaced -->
<!-- with~1. See~\ref{app:cov} for more details on the derivation. -->
<!-- Note that as the spatial dependence gets stronger, the variance of the -->
<!-- estimator increases, which is in contrast to the model-based approach in the -->
<!-- next subsection. -->
<!-- \section{Covariance Terms Approximation for Areal interpolation} -->
<!-- \label{app:cov} -->
<!-- \jy{redundant section; repeating equations in the text.} -->
<!-- We first propose an easily scalable extension of an existing nonparametric -->
<!-- interpolation approach that accounts for the observed variance information as -->
<!-- well as the spatial dependence at the census tract level based on an -->
<!-- approximation using Moran´s~I \citep{moran1950notes}. -->
<!-- Using Equation~\eqref{eq:np-est}, the areal interpolation estimate for $Y(s_i)$ -->
<!-- is -->
<!-- \begin{align*} -->
<!--   \hat{Y}(s_i) & = \mathbf{w}^\top_i Y(B_1, \ldots, B_n) -->
<!--   = \sum_{j = 1}^m w_{ij} Y(B_j), -->
<!-- \end{align*} -->
<!-- where $\mathbf{w}_i$ is the $i$-th row of the matrix $\mathbf{W}$ defined in -->
<!-- Section~\ref{app:nonpar}. The derivation in Equation~\eqref{eq:np-single-var} -->
<!-- follows directly from the variance operator. For each $j$ and $l$, the -->
<!-- Cauchy--Schwartz inequality gives -->
<!-- \begin{equation} -->
<!--   \label{eq:cs_ineq} -->
<!--   \textrm{Cov}[Y(B_j), Y(B_l)] \leq \sqrt{\text{Var}[Y(B_j)] -->
<!--     \text{Var}[Y(B_l)]}, \quad \forall j, l = 1, \ldots, m. -->
<!-- \end{equation} -->
<!-- By combining Equations~\eqref{eq:cs_ineq} and~\eqref{eq:np-single-var}, we have -->
<!-- \begin{equation*} -->
<!--   \text{Var}[\hat{Y}(s_i)] \leq \sum_{j = 1}^m w^2_{ij} \text{Var} \left [ Y(B_j) \right ] + 2 \sum_{l -->
<!--     \neq j} w_{ij} w_{il} \sqrt{\text{Var}[Y(B_j)] -->
<!--     \text{Var}[Y(B_l)]}. -->
<!-- \end{equation*} -->
<!-- The proposition in Equation~\eqref{eq:cova} is the multiply the upper-bounds -->
<!-- given by Equation~\eqref{eq:cs_ineq} by the Moran's~I, denoted -->
<!-- $\rho_I \in (-1, 1)$, resulting in a less conservative approximation. -->
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bradley2016bayesian" class="csl-entry">
Bradley, Jonathan R., Christopher K. Wikle, and Scott H. Holan. 2016.
<span>“Bayesian Spatial Change of Support for Count-Valued Survey Data
with Application to the American Community Survey.”</span> <em>Journal
of the American Statistical Association</em> 111 (514): 472–87. <a href="https://doi.org/10.1080/01621459.2015.1117471" class="external-link">https://doi.org/10.1080/01621459.2015.1117471</a>.
</div>
<div id="ref-goodchild1980areal" class="csl-entry">
Goodchild, Michael F, and Nina Siu-Ngan Lam. 1980. <span>“Areal
Interpolation: <span>A</span> Variant of the Traditional Spatial
Problem.”</span> <em>Geo-Processing</em> 1: 279–312.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Powered by <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Lucas da Cunha Godoy. Provided without any warranty.</p>
</div>

    </footer>
</div>





  </body>
</html>
