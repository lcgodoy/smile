<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5. Spatial covariance functions • smile</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5. Spatial covariance functions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smile</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> HOME</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/sf-to-spm.html">1. Converting sf objects to spm</a></li>
    <li><a class="dropdown-item" href="../articles/fit-and-pred.html">2. Fitting models and making predictions</a></li>
    <li><a class="dropdown-item" href="../articles/sai.html">3. Areal Interpolation</a></li>
    <li><a class="dropdown-item" href="../articles/theory.html">4. Method</a></li>
    <li><a class="dropdown-item" href="../articles/sp-cov-functions.html">5. Spatial covariance functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search fa-lg"></span> Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://lcgodoy.me" aria-label="Personal website"><span class="fa fa-globe"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lcgodoy" aria-label="GitHub Profile"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.linkedin.com/in/godoy-lucas/" aria-label="Linkedin Profile"><span class="fa fa-linkedin"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>5. Spatial covariance functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lcgodoy/smile/blob/main/vignettes/sp-cov-functions.Rmd" class="external-link"><code>vignettes/sp-cov-functions.Rmd</code></a></small>
      <div class="d-none name"><code>sp-cov-functions.Rmd</code></div>
    </div>

    
    
<p>In this short vignette, we illustrate the family of spatial
covariance functions implemented in this package. Note that, all of them
are based on the assumptions of stationarity and isotropy of the
underlying Gaussian random field (GRF). Also, the implementations (and
definitions) are based on the families of spatial <em>correlation</em>
functions presented in <span class="citation">Diggle and Ribeiro
(2007)</span>. The implementations make use of the
<code>RcppArmadillo</code> <span class="citation">(Eddelbuettel and
Sanderson 2014)</span> package and the STL library algorithms (C++ 11)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;for this problem, the implementation using the
sequential algorithms of the STL library was more efficient than those
using the &lt;code&gt;RcppParallel&lt;/code&gt; package&lt;/p&gt;"><sup>1</sup></a>.</p>
<p>The first spatial covariance family implemented is the so-called
Matérn Covariance function, which is defined as <span class="math display">$$
{\rm C}(h; \sigma^2, \phi, \kappa) = \sigma^2 \frac{(h / \phi)^{\kappa}
K_{\kappa}( h / \phi )} { 2^{\kappa - 1} \Gamma(\kappa) }.
$$</span> Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is the distance between two points,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
is a variance parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>
is the scale parameter that controls the reach of the spatial
dependence, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
is a shape parameter that controls the smoothness of the process. The
function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>κ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">K_{\kappa}(\cdot)</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>-order
Modified Bessel function of Second-Kind. There are special cases of the
Matérn family implemented on the package, when setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">3/2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">5/2</annotation></semantics></math>,
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">\to \infty</annotation></semantics></math>
the expression simplifies. The first and the last cases yield to the
Exponential and Gaussian family, respectively.</p>
<p>The second spatial covariance family implemented is the Powered
Exponential Covariance function, it is defined as <span class="math display">$$
{\rm C}(h; \sigma^2, \phi, \kappa) = \sigma^2 \exp \{ - (h /
\phi)^{\kappa} \},
$$</span> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is the distance between two points,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
analogous to the Matérn function.</p>
<p>The penultimate option is the Gaussian family of covariance
functions. The expression associated with this family is written as
<span class="math display">$$
{\rm C}(h; \sigma^2, \phi) = \sigma^2 \exp \left\{ - \frac{h ^ 2}{2 \phi
^ 2} \right\},
$$</span> again, the parameters are analogous to what have defined
before in this vignette.</p>
<p>Lastly, we have implemented the Spherical family of covariance
functions, defined as <span class="math display">$$
{\rm C}(h; \sigma^2, \phi) =
\sigma^2
\begin{cases}
1 - \frac{3}{2} (h / \phi) + \frac{1}{2} (h / \phi) ^ 3 &amp; , \,
0 \leq h \leq \phi \\
0 &amp; , \, h &gt; \phi,
\end{cases}
$$</span> where, again,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
is a variance parameter, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\phi &gt; 0</annotation></semantics></math>
is a parameter with the same magnitude as the distances on which the
function is being evaluated at and controls the speed of decay of the
spatial covariances as we increase the distance between two points.</p>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-diggle2007model" class="csl-entry">
Diggle, PJ, and Paulo Justiniano Ribeiro. 2007. <span>“Model-Based
Geostatistics (Springer Series in Statistics).”</span> In, 51–56.
Springer.
</div>
<div id="ref-eddelbuettel2014rcpparmadillo" class="csl-entry">
Eddelbuettel, Dirk, and Conrad Sanderson. 2014. <span>“RcppArmadillo:
Accelerating r with High-Performance c++ Linear Algebra.”</span>
<em>Computational Statistics &amp; Data Analysis</em> 71: 1054–63.
</div>
</div>
</div>

  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Powered by <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Lucas da Cunha Godoy. Provided without any warranty.</p>
</div>

    </footer>
</div>





  </body>
</html>
