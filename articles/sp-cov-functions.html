<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Spatial covariance functions • spmismo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Spatial covariance functions">
<meta property="og:description" content="spmismo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spmismo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fit-and-pred.html">3. Fitting models and making predictions</a>
    </li>
    <li>
      <a href="../articles/sf-to-spm.html">1. Converting sf objects to spm</a>
    </li>
    <li>
      <a href="../articles/sp-cov-functions.html">2. Spatial covariance functions</a>
    </li>
    <li>
      <a href="../articles/theory.html">4. Theory</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lcgodoy/spmismo/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sp-cov-functions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Spatial covariance functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lcgodoy/spmismo/blob/master/vignettes/sp-cov-functions.Rmd"><code>vignettes/sp-cov-functions.Rmd</code></a></small>
      <div class="hidden name"><code>sp-cov-functions.Rmd</code></div>

    </div>

    
    
<!-- To exemplify the covariance functions, we are going to use the data from -->
<!-- @johnson2020dealing again^[for more details about the data, take a look at the -->
<!-- vignette -->
<!-- [sf-to-spm](https://lcgodoy.me/spmismo/articles/sf_to_spm.html)]. First, in the -->
<!-- code cunk below, we load the data and convert it to a `spmismo` compatible -->
<!-- class. Since this is a toy example, we are going to generate a 500 points grid -->
<!-- for the data. -->
<p>in this short vignette, we illustrate the family of spatial covariance functions implemented in this package. Note that, all of them are based on the assumptions of stationarity and isotropy of the underlying Gaussian Random Field (GRF). Also, the implementations (and definitions) are based on the families of spatial <em>correlation</em> functions presented in <span class="citation">Diggle and Ribeiro (2007)</span>. The implemtations make use of the <code>RcppArmadillo</code> <span class="citation">(Eddelbuettel and Sanderson 2014)</span> package and the STL library algorithms (C++ 11)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>The first spatial covariance family implemented is the so-called Mat'ern Covariance function, it is of form <span class="math display">\[
C(h; \sigma^2, \phi, \kappa) = \sigma^2 frac{(h / \phi)^{\kappa} K_{\kappa}( h / \phi )}
{ 2^{\kappa - 1} \Gamma(\kappa) },
\]</span> where <span class="math inline">\(h\)</span> is the distance between two points, <span class="math inline">\(\sigma^2\)</span> is analogous to a variance parameter, <span class="math inline">\(\phi\)</span> is the scale parameter that controls the rech of the spatial dependence, and <span class="math inline">\(\kappa\)</span> is a shape parameter that controls the differentiability of the process. The function <span class="math inline">\(K_{\kappa}(\cdot)\)</span> is the <span class="math inline">\(\kappa\)</span>-order Modified Bessel function of Second-Kind There are special cases of the Mat'er family implemented on the package, when setting <span class="math inline">\(\kappa\)</span> to <span class="math inline">\(1/2\)</span>, <span class="math inline">\(3/2\)</span>, <span class="math inline">\(5/2\)</span>, or <span class="math inline">\(\infty\)</span> the expression simplifies. The first and the last cases yields to the Exponential and Gaussian family, respectively.</p>
<p>The second spatial covariance family implemented is the Powered Exponential Covariance function, it is defined as <span class="math display">\[
C(h; \sigma^2, \phi, \kappa) = \sigma^2 \exp \{ - (h / \phi)^{\kappa} \},
\]</span> where <span class="math inline">\(h\)</span> is the distance between two points, <span class="math inline">\(\sigma^2\)</span> is analogous to a variance parameter, <span class="math inline">\(\phi\)</span> is the scale parameter that controls the rech of the spatial dependence, and <span class="math inline">\(\kappa\)</span> is a shape parameter that controls the differentiability of the process.</p>
<p>The penultimate option is the Gaussian family of covariance functions, they are defined as <span class="math display">\[
C(h; \sigma^2, \phi) = \sigma^2 \exp \left\{ - \frac{h ^ 2}{2 \phi ^ 2} \right\},
\]</span> the parameters are analogous to those defined by the previous two families. Note that, this family has one less parameter as the previously defined ones.</p>
<p>Lastly, we have implemented the Spherical family of covariance functions, defined as <span class="math display">\[
C(h; \sigma^2, \phi) = 
\sigma^2 
\begin{cases}
1 - \frac{3}{2} (h / \phi) + \frac{1}{2} (h / \phi) ^ 3 &amp; , \,
0 \geq h \geq \phi \\
0 &amp; , \, h &gt; \phi,
\end{cases}
\]</span> where, again, <span class="math inline">\(\sigma^2\)</span> is a variance parameter, while $&gt; 0 $ is a parameter with the same magnitude as the distances on which the function is being evaluated at.</p>
<p>All this functions will be useful in the upcoming vignette.</p>
<div id="reference" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#reference" class="anchor"></a>Reference</h1>
<div id="refs" class="references">
<div id="ref-diggle2007model">
<p>Diggle, PJ, and Paulo Justiniano Ribeiro. 2007. “Model-Based Geostatistics (Springer Series in Statistics).” In, 51–56. Springer.</p>
</div>
<div id="ref-eddelbuettel2014rcpparmadillo">
<p>Eddelbuettel, Dirk, and Conrad Sanderson. 2014. “RcppArmadillo: Accelerating R with High-Performance C++ Linear Algebra.” <em>Computational Statistics &amp; Data Analysis</em> 71: 1054–63.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>for this problem, the implementation using the sequencial algorithms of the STL library were more effitient than those using the <code>RcppParallel</code> package<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lucas Godoy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
