<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="smile">
<title>1. Converting sf objects to spm • smile</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Converting sf objects to spm">
<meta property="og:description" content="smile">
<meta property="og:image" content="https://lcgodoy.me/smile/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">smile</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--vignettes">
    <span class="fa fa-book fa-lg"></span>
     
    Vignettes
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--vignettes">
    <a class="dropdown-item" href="../articles/sf-to-spm.html">1. Converting sf objects to spm</a>
    <a class="dropdown-item" href="../articles/fit-and-pred.html">2. Fitting models and making predictions</a>
    <a class="dropdown-item" href="../articles/sai.html">3. Areal Interpolation</a>
    <a class="dropdown-item" href="../articles/theory.html">4. Method</a>
    <a class="dropdown-item" href="../articles/sp-cov-functions.html">5. Spatial covariance functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-search fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lcgodoy">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stacksoverflow.com/users/9220758/lcgodoy">
    <span class="fa fa-stack-overflow fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/ldcgodoy">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.linkedin.com/in/godoy-lucas/">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>1. Converting sf objects to spm</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lcgodoy/smile/blob/HEAD/vignettes/sf-to-spm.Rmd" class="external-link"><code>vignettes/sf-to-spm.Rmd</code></a></small>
      <div class="d-none name"><code>sf-to-spm.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lcgodoy.me/smile/">smile</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>Often, in an applied setting, it is desirable to change the spatial
support of some variables in order to conduct either association or
regression analysis. This package provides functions to deal with this
problem under two different approaches, a model-based one and a
(non-parametric) spatial interpolation.</p>
<p>The purpose of this vignette is to illustrate how to convert
<code>sf</code><span class="citation">(Pebesma 2018)</span> objects to
objects support by the <code>smile</code> package. Besides these two
packages, we are going to use the <code>ggplot2</code><span class="citation">(Wickham 2011)</span> package for the data
visualization.</p>
<p>This vignette is useful when the user wants to pursue the model-based
approach. The methodology is based on the assumption that areal data
(e.g., variables measured at census tracts) are composed by averages of
a continuous underlying process <span class="citation">Johnson, Diggle,
and Giorgi (2020)</span>. In practice, there exists an identifiability
problem when estimating some variance parameters, which can be seen
either as small scale variation (nugget effect) or measurement errors.
When fitting models, the users may chose to ignore the measurement error
associated with the problem. Model fitting and prediction are explained
in the vignette available on <a href="https://lcgodoy.me/smile/articles/fit-and-pred.html">this
link</a>.</p>
<p>To illustrate how to convert <code>sf</code> polygons into
<code>spm</code> objects, we are going to use the datasets provided by
<span class="citation">Johnson, Diggle, and Giorgi (2020)</span>. For
this data, we have the Life Expectancy at Birth (LEB) and the Index of
Multiple Deprivation (IMD) in Liverpool. These variables are observed at
the Middle Super Output Areas (MSOA) and Lower Super Output Areas
(LSOA), respectively. After loading our package, the datasets can be
loaded by simply running the chunk of code below. Figure <span class="math inline">\(\ref{fig:leb-msoa}\)</span> displays the LEB at
the MSOA.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">liv_lsoa</span><span class="op">)</span> <span class="co"># loading the LSOA data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">liv_msoa</span><span class="op">)</span> <span class="co"># loading the MSOA data</span></span>
<span></span>
<span><span class="co">## workaround for compatibility with different PROJ versions</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">liv_msoa</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">liv_msoa</span><span class="op">)</span><span class="op">$</span><span class="va">input</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">liv_lsoa</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">liv_lsoa</span><span class="op">)</span><span class="op">$</span><span class="va">input</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">liv_msoa</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">leb_est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>            lwd   <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_b</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="sf-to-spm_files/figure-html/read-data-1.png" alt="LEB in Liverpool at the MSOA." width="700"><p class="caption">
LEB in Liverpool at the MSOA.
</p>
</div>
<!-- We consider, in a first moment, that this random variable is normally -->
<!-- distributed with a constant mean and a certain (spatial) covariance -->
<!-- matrix. Now, let $A_1$ and $A_2$ be two distinct MSOA's. Under the -->
<!--
before mentioned assumption that the observed random variable is driven -->
<!--
by an underlying Gaussian random field with isotropic covariance -->
<!--
function $C(\lVert x - y \rVert \, ; \, \theta)$, where $\lVert x - y -->
<!--
\rVert$ is the distance between two points in the coordinates $x$ and -->
<!--
$y$, respectively. Then, the covariance between the (averaged) variable -->
<!--
observed at $A_1$ and $A_2$ is define as \[ \Sigma_{12} = Cov(A_1, A_2) -->
<!--
= \frac{1}{\lvert A_1 \rvert \lvert A_2 \rvert} \int_{A_1} \int_{A_2} -->
<!--
C(\lVert x - y \rVert; \theta) \, dy \, dx.  \] In order to approximate -->
<!--
the continuous surface on which these covariances have to be computed, -->
<!--
we generate a fine grid over the whole study region (or a fine grid -->
<!--
within each MSOA) and approximate such covariance by numerical integration. -->
<p>Now, suppose we are interested in estimating the LEB at the LSOA, so
we will be able to conduct association analysis between LEB and IMD at
the MSOA level. We assume, that the LEB, denoted <span class="math inline">\(Y(\cdot)\)</span>, is driven by a stationary and
isotropic continuous Gaussian process over the region of study, such
that, the observed data at the <span class="math inline">\(i\)</span>-th
MSOA area (denoted <span class="math inline">\(A_i\)</span>) is an
average of this underlying process. If we knew the parameters and
covariance function associated with this process, then the LEB at the
<span class="math inline">\(i\)</span>-th MSOA would be as follow <span class="math display">\[
    Y(A_i) = \frac{1}{\lvert A_i \rvert} \int_{A_i} Y(\mathbf{s}) \,
{\rm d}
    \mathbf{s},
\]</span> where <span class="math inline">\(\lvert A_i \rvert\)</span>
stands for the area associated with the region <span class="math inline">\(A_i\)</span>.</p>
<p>Similarly, <span class="math display">\[\begin{align*}
{\rm E}[Y(A_i)] &amp; = \frac{1}{\lvert A_i \rvert} \int_{A_i} {\rm
E}[Y(\mathbf{s})] \, {\rm d} \mathbf{s} \\
&amp; = \frac{1}{\lvert A_i \rvert} \int_{A_i} \mu \, {\rm d} \mathbf{s}
\\
&amp; = \mu,
\end{align*}\]</span> and <span class="math display">\[\begin{align*}
{\rm Cov}[Y(A_i), Y(A_j)] &amp; = \frac{1}{\lvert A_i \rvert \lvert A_j
\rvert}
\int_{A_i \times A_j} {\rm Cov}[Y(\mathbf{s}, Y(\mathbf{s}')] \,
{\rm d}
\mathbf{s} \, {\rm d} \mathbf{s'} \\
&amp; = \frac{1}{\lvert A_i \rvert \lvert A_j \rvert} \int_{A_i \times
A_j} {\rm C}(
\lVert \mathbf{s} - \mathbf{s}' \rVert ; \boldsymbol{\theta}) \,
{\rm d}
\mathbf{s} \, {\rm d} \mathbf{s'},
\end{align*}\]</span> where <span class="math inline">\(\lVert
\mathbf{s} - \mathbf{s}' \rVert\)</span> is the Euclidean distance
between the coordinates <span class="math inline">\(\mathbf{s}\)</span>
and <span class="math inline">\(\mathbf{s}'\)</span>, and <span class="math inline">\({\rm C}( \lVert
\mathbf{s} - \mathbf{s}' \rVert ; \boldsymbol{\theta})\)</span> is
an isotropic covariance function depending on the parameter <span class="math inline">\(\boldsymbol{\theta}\)</span>.</p>
<p>In practice, however, the integrals in the equation above are hard to
be evaluated analytically. A common workaround is to evaluate them
either numerically or by Monte Carlo integration <span class="citation">(Gelfand, Zhu, and Carlin 2001)</span>. When using the
function <code>sf_to_spm</code>, the parameter <code>"type"</code>
controls the method of integration. The options are
<code>"regular"</code> (or <code>"hexagonal"</code>) for numerical
integration, or <code>"random"</code> for Monte Carlo integration.
Regardless of the <code>"type"</code> chosen, we have to generate a grid
of points over the study region. When doing so, we may chose whether we
want to approximate the integral within each area with the same
precision or if we want the precision to vary according to the size of
the polygon. This is controlled by the parameter
<code>"by_polygon"</code>, which is a boolean scalar. When set to
<code>TRUE</code>, all the integrals will be estimated with the same
precision, regardless of the size of the polygon. On the other hand, if
this parameter is set to <code>FALSE</code>, the grid of points will be
generated over the whole study region and, afterwards, the points will
be attributed to the areas they are contained in. This way, larger
polygons will contain more points and, thus, the respective integrals
will have a smaller numerical error. Lastly, there exists a parameter
called <code>"npts"</code>. This parameter controls the number of points
used to compute this integrals. We may either input a vector with the
same length as the number of areas or a scalar. When inputting a scalar,
this scalar will stand for the number of points over the whole city if
<code>by_polygon = FALSE</code> and the number of points per polygon
(area) otherwise.</p>
<!-- Firstly, we are going to show how does it work with a single `sf` -->
<!-- object. Besides the `sf` objects, this function has 5 additional arguments. The -->
<!-- first one, called `n_pts`, controls the number of points we are going to -->
<!-- generate to create a grid within the study region. We can input either a single -->
<!-- (integer) value or a vector with length equal to the number of rows of the `sf` -->
<!-- objected being analyzed. The next parameter is called `type`. This one is string -->
<!-- scalar that assumes either `"random"`, `"regular"`, or `"hexagonal"`. Finally, -->
<!-- the parameter `by_polygon` is a logical that if set to `TRUE`, will generate -->
<!-- `n_pts` for each polygon within the study region^[This parameter has to be set -->
<!-- to `TRUE` when `n_pts` is a vector.]. The last two parameters are `poly_ids` and -->
<!-- `var_ids`. Both are strings, the first one is a scalar representing the variable -->
<!-- that uniquely identify each polygon within the study region, while the second -->
<!-- one indicates which (numerical) variables we want to analyze. For example, in -->
<!-- the code chunk below, we are transforming the `sf` object `liv_msoa` into a -->
<!-- `smile` compatible object. We are going to generate a grid of 1000 points -->
<!-- within the study region, with `type = "regular"`, and `by_polygon = FALSE`. The -->
<!-- id variable is called `"msoa11cd"` and the numerical variable that we are -->
<!-- interested in is called `"leb_est"`. The object returned by the function is of -->
<!-- class `"sspm"`^[when we use more than one partition, the resulting class is -->
<!-- `"mspm"`]. Under the hood, this object is a 5 positions named list. The first -->
<!-- position is called `"var"` and stores the numerical variable (or variables) to -->
<!-- be analyzed. The second position is named `"dists"` and stores the pairwise -->
<!-- distances between points belonging to different polygons, this object is -->
<!-- important to calculate the covariance matrix associated with the polygons. The -->
<!-- third positions stores the name of the id variable, while the fourth and fifth -->
<!-- positions contain the grid of points generated and the polygon associated with -->
<!-- the data. All these objects are used in functions that will be explained further -->
<!-- in other vignettes.  -->
<p>If we wish to estimate the LEB in the LSOA areas, we will need to
create a <code>spm</code> object associated with this variable, fit the
model, and then compute the predictions. The chunk of code below shows
how to convert the <code>liv_msoa</code> (of class <code>sf</code>) to a
<code>spm</code> object. In this case, we are generating a grid of 1000
points over the whole city of Liverpool, then we will be attributing
each of these points to the area they are contained in. Also, the
<code>"poly_ids"</code> argument is a string indicating the variable in
the <code>liv_msoa</code> dataset that contains the unique identifier
associated with each area. The argument <code>"var_ids"</code> is a
string as well but this indicates the “response variable”. That is, the
variable that for which we will be interested in fitting a model to.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msoa_spm</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="../reference/sf_to_spm.html">sf_to_spm</a></span><span class="op">(</span>sf_obj <span class="op">=</span> <span class="va">liv_msoa</span>, n_pts <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"regular"</span>, by_polygon <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              poly_ids <span class="op">=</span> <span class="st">"msoa11cd"</span>, var_ids <span class="op">=</span> <span class="st">"leb_est"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, the Figure below displays the grids associated with each of
the possible combinations of the parameters <code>type</code> and
<code>by_polygon</code> when calling the <code>sf_to_spm</code>
function.
<!-- Next, we illustrate how do different values of `type` and `by_polygon` affect -->
<!-- the final result of the `sf_to_spm` call. In all examples we are going to use a -->
<!-- grid of 305 points (multiple of the number of polygons observed). The "sparsity" -->
<!-- of the points forming the grid helps to see the differences caused by the -->
<!-- different inputs for the function. The panel below displays every possible -->
<!-- combination of the parameters `type` and `by_polygon`. Although there is no -->
<!-- "right" choice for these parameters, we advise using `type` as `"regular"` or -->
<!-- `"hexagonal"` with by `by_polygon = FALSE`. Also, it is import to make sure -->
<!-- that, after generating the grid, your grid is in a finer resolution than your -->
<!-- smallest polygon, that is, to make sure that there exists no points lying in -->
<!-- more than one polygon. -->
<img src="sf-to-spm_files/figure-html/sf-to-spm2-1.png" width="700"></p>
<p>For details on fitting models and making precitions, see <a href="https://lcgodoy.me/smile/articles/fit-and-pred.html">this
vignette</a>.</p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gelfand2001change" class="csl-entry">
Gelfand, Alan E, Li Zhu, and Bradley P Carlin. 2001. <span>“On the
Change of Support Problem for Spatio-Temporal Data.”</span>
<em>Biostatistics</em> 2 (1): 31–45.
</div>
<div id="ref-johnson2020dealing" class="csl-entry">
Johnson, Olatunji, Peter Diggle, and Emanuele Giorgi. 2020.
<span>“Dealing with Spatial Misalignment to Model the Relationship
Between Deprivation and Life Expectancy: <span>A</span> Model-Based
Geostatistical Approach.”</span> <em>International Journal of Health
Geographics</em> 19 (1): 1–13.
</div>
<div id="ref-moraga2017geostatistical" class="csl-entry">
Moraga, Paula, Susanna M Cramb, Kerrie L Mengersen, and Marcello Pagano.
2017. <span>“A Geostatistical Model for Combined Analysis of Point-Level
and Area-Level Data Using INLA and SPDE.”</span> <em>Spatial
Statistics</em> 21: 27–41.
</div>
<div id="ref-pebesma2018simple" class="csl-entry">
Pebesma, Edzer. 2018. <span>“<span class="nocase">Simple Features for R:
Standardized Support for Spatial Vector Data</span>.”</span>
<em><span>The R Journal</span></em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-wickham2011ggplot2" class="csl-entry">
Wickham, Hadley. 2011. <span>“Ggplot2.”</span> <em>Wiley
Interdisciplinary Reviews: Computational Statistics</em> 3 (2): 180–85.
</div>
<div id="ref-wilson2020pointless" class="csl-entry">
Wilson, Katie, and Jon Wakefield. 2020. <span>“Pointless Spatial
Modeling.”</span> <em>Biostatistics</em> 21 (2): e17–32.
</div>
</div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Powered by <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Lucas da Cunha Godoy. Provided without <strong>any warranty</strong>.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
